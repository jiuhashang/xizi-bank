{"remainingRequest":"C:\\Users\\ylf\\Desktop\\xizi - bank\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\ylf\\Desktop\\xizi - bank\\src\\components\\GlobalComponents\\CustomTable\\index.vue?vue&type=style&index=0&id=a8185a8c&lang=scss&","dependencies":[{"path":"C:\\Users\\ylf\\Desktop\\xizi - bank\\src\\components\\GlobalComponents\\CustomTable\\index.vue","mtime":1642644134572},{"path":"C:\\Users\\ylf\\Desktop\\xizi - bank\\node_modules\\css-loader\\dist\\cjs.js","mtime":1668673146952},{"path":"C:\\Users\\ylf\\Desktop\\xizi - bank\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1668673148673},{"path":"C:\\Users\\ylf\\Desktop\\xizi - bank\\node_modules\\postcss-loader\\src\\index.js","mtime":1668673147587},{"path":"C:\\Users\\ylf\\Desktop\\xizi - bank\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1668673148073},{"path":"C:\\Users\\ylf\\Desktop\\xizi - bank\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1668673146435},{"path":"C:\\Users\\ylf\\Desktop\\xizi - bank\\node_modules\\vue-loader\\lib\\index.js","mtime":1668673148087}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiV0YWJsZVN0eWxlIHsKICB3aWR0aDogMTAwJTsKCiAgLmVsLXRhYmxlIHsKICAgIHdpZHRoOiAxMDAlOwoKICAgIC5lbC1yYWRpb19fbGFiZWwgewogICAgICBwYWRkaW5nOiAwcHg7IC8qIOa4hemZpGVsLXJhZGlv57uE5Lu26buY6K6k55qE5YaF6L656LedICovCiAgICB9CgogICAgLmNlbGwgewogICAgICB3aWR0aDogMTAwJSAhaW1wb3J0YW50OwogICAgfQogIH0KICAgICAgLmN1c3RvbS11cGxvYWQgewogICAgLyog6Kej5Yaz5Zu+54mH5LiK5Lyg5ZCO5Y2V5YWD5qC85Y+Y5b2i6Zeu6aKYICovCiAgICA6OmRlZXAgLmVsLXVwbG9hZC1saXN0IHsKICAgICAgbGluZS1oZWlnaHQ6IDBweDsKICAgIH0KICB9CgogIC8qIOino+WGs2VsZW1lbnQtdWnnmoR0YWJsZeihqOagvOihqOWktOS4juWGheWuueWIl+S4jeWvuem9kOmXrumimCAqLwogIHRoLmd1dHRlciB7CiAgICBkaXNwbGF5OiB0YWJsZS1jZWxsICFpbXBvcnRhbnQ7CiAgfQoKICAvKiDop6PlhrNlbGVtZW50LXVp55qEZml4ZWTliJfplJnkvY3pl67popggKi8KICAuZWwtdGFibGVfX2ZpeGVkIHsKICAgIGRpc3BsYXk6IHRhYmxlLWNlbGwgIWltcG9ydGFudDsKICAgIGhlaWdodDogMTAwJSAhaW1wb3J0YW50OwoKICAgIC5lbC10YWJsZV9fZml4ZWQtYm9keS13cmFwcGVyIHsKICAgICAgdG9wOiA0OHB4ICFpbXBvcnRhbnQ7CiAgICB9CiAgfQp9CgoudGFibGUtdmlldyB7CiAgQGV4dGVuZCAldGFibGVTdHlsZTsKICBmbGV4OiAxOwp9CgouZmx1aWQtdGFibGUgewogIEBleHRlbmQgJXRhYmxlU3R5bGU7CiAgaGVpZ2h0OiBtYXgtY29udGVudDsKCiAgLmVsLXRhYmxlIHsKICAgIGhlaWdodDogMTAwJSAhaW1wb3J0YW50OwogIH0KfQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAgTA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/GlobalComponents/CustomTable","sourcesContent":["<template>\r\n  <div :id=\"`table_${componentKey}`\" :class=\"maxHeight?'fluid-table':'table-view'\">\r\n    <el-table\r\n      :ref=\"`table_${componentKey}`\"\r\n      v-loading=\"loading\"\r\n      :data=\"tableData\"\r\n      :height=\"tableHeight || customHeight\"\r\n      :default-sort=\"defaultSort\"\r\n      :max-height=\"maxHeight\"\r\n      :highlight-current-row=\"highlightCurrentRow\"\r\n      :row-class-name=\"setRowIndex\"\r\n      :border=\"border\"\r\n      :header-cell-style=\"{background:'#f2f2f2',color:'#555'}\"\r\n      :span-method=\"spanMethod\"\r\n      fit\r\n      stripe\r\n      header-row-class-name=\"table-header\"\r\n      @selection-change=\"handleSelectionChange\"\r\n      @current-change=\"handleCurrentChange\"\r\n      @sort-change=\"sortChange\"\r\n      @cell-click=\"editCell\"\r\n    >\r\n      <!-- 单选按钮列 -->\r\n      <el-table-column\r\n        v-if=\"highlightCurrentRow\"\r\n        fixed\r\n        prop=\"index\"\r\n        label=\"选择\"\r\n        align=\"center\"\r\n        width=\"55\"\r\n      >\r\n        <template slot-scope=\"scope\">\r\n          <el-radio v-model=\"rowIndex\" :label=\"scope.row.index\"><i /></el-radio>\r\n        </template>\r\n      </el-table-column>\r\n\r\n      <!-- 多选按钮列(无法与单选列同时显示,单选/多选同时设置启用时,默认只启用单选列) -->\r\n      <el-table-column\r\n        v-if=\"selection && !highlightCurrentRow\"\r\n        fixed\r\n        align=\"center\"\r\n        type=\"selection\"\r\n        width=\"55\"\r\n      />\r\n\r\n      <!-- 序号列，使表格每行数据可以取到index属性 -->\r\n      <el-table-column\r\n        v-if=\"indexVisible\"\r\n        type=\"index\"\r\n        label=\"序号\"\r\n        align=\"center\"\r\n        width=\"50\"\r\n      />\r\n\r\n      <slot name=\"beforeSlot\" />\r\n\r\n      <template v-for=\"(item, index) in columnList\">\r\n        <select-column\r\n          v-if=\"item.type && item.type === 'selection'\"\r\n          :key=\"index\"\r\n          :column=\"item\"\r\n          :index=\"index\"\r\n        />\r\n\r\n        <general-column\r\n          v-else\r\n          :key=\"index\"\r\n          :column=\"item\"\r\n          :index=\"index\"\r\n          :empty-cell=\"emptyCell\"\r\n          @cellInputBlur=\"cellInputBlur\"\r\n        />\r\n      </template>\r\n\r\n      <slot />\r\n\r\n    </el-table>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport * as props from './props.js'\r\nimport GeneralColumn from './GeneralColumn'\r\nimport SelectColumn from './SelectColumn'\r\n\r\nexport default {\r\n  components: {\r\n    GeneralColumn,\r\n    SelectColumn\r\n  },\r\n  props: {\r\n    ...props.originalProps,\r\n    ...props.customProps\r\n  },\r\n  data() {\r\n    return {\r\n      tableHeight: 0, // 表格的默认高度\r\n      rowIndex: 0 // 组件单选功能的选中值\r\n    }\r\n  },\r\n  watch: {\r\n    // 监听tableData的异步请求结果变化\r\n    tableData: {\r\n      handler(nv, ov) {\r\n        // 若组件开启单行选择,并且tableData不为空数组\r\n        if (nv.length > 0 && this.highlightCurrentRow) {\r\n          // 向父组件发送初始的选中行数据\r\n          this.$emit('currentChange', nv[this.rowIndex])\r\n        }\r\n        // 解决表格出现滚动条之后table表格表头与内容列不对齐问题\r\n        this.fixLayout()\r\n      },\r\n      deep: true,\r\n      immediate: true\r\n    },\r\n\r\n    // 监听表格勾选项的变化\r\n    selectedList: {\r\n      handler(nv, ov) {\r\n        if (nv.length > 0) {\r\n          // 设置表格的默认选中项\r\n          this.toggleSelection(nv)\r\n        }\r\n      },\r\n      deep: true,\r\n      immediate: true\r\n    },\r\n\r\n    // 监听loading的变化\r\n    loading: {\r\n      handler(nv, ov) {\r\n      },\r\n      deep: true,\r\n      immediate: true\r\n    }\r\n  },\r\n  mounted() {\r\n    // 计算自适应表格的高度\r\n    this.setHeight()\r\n    window.onresize = this.$utils.debounce(() => {\r\n      this.setHeight()\r\n    }, 300)\r\n\r\n    // 监听页面中本组件的componentKey是否重复\r\n    this.componentKeyWasRepeat()\r\n  },\r\n  methods: {\r\n    // 禁止页面中出现重复的componentKey\r\n    componentKeyWasRepeat() {\r\n      // 页面中同id的本组件数量\r\n      const keys = document.querySelectorAll(`#table_${this.componentKey}`).length\r\n      if (keys > 1) {\r\n        const error = new Error()\r\n        // 错误提示: 值为'xxx'的'componentKey'出现重复。请为每个'custom-table'组件设置不同的'componentKey'\r\n        error.message = `The 'componentKey' value of ${this.componentKey} is repeated. please set a different 'componentKey' for each 'custom-table' component`\r\n        // 抛出错误\r\n        throw (error)\r\n      }\r\n    },\r\n\r\n    // 解决表格出现滚动条之后table表格表头与内容列不对齐问题\r\n    fixLayout() {\r\n      setTimeout(() => {\r\n        try {\r\n          this.$refs.table.doLayout()\r\n        } catch (error) {\r\n          // throw (error)\r\n        }\r\n      }, 1500)\r\n    },\r\n\r\n    // 自动设置表格高度\r\n    setHeight() {\r\n      this.$nextTick(() => {\r\n        // 没有设置max-height时才计算固定高度\r\n        if (!this.maxHeight) {\r\n          this.tableHeight = document.getElementById(`table_${this.componentKey}`).offsetHeight\r\n        }\r\n      })\r\n    },\r\n\r\n    // 指定表格多选项的勾选状态批量切换\r\n    toggleSelection(rows) {\r\n      if (rows.length > 0) {\r\n        rows.forEach(row => {\r\n          this.$nextTick(() => {\r\n            this.$refs[`table_${this.componentKey}`].toggleRowSelection(row)\r\n          })\r\n        })\r\n      } else {\r\n        this.$refs[`table_${this.componentKey}`].clearSelection()\r\n      }\r\n    },\r\n\r\n    // 获取勾选项\r\n    handleSelectionChange(row) {\r\n      // row: 行数据\r\n      this.$emit('getSelectionChange', row)\r\n    },\r\n\r\n    // 清除勾选项\r\n    clearSelection() {\r\n      this.$refs[`table_${this.componentKey}`].clearSelection()\r\n    },\r\n\r\n    // 通过row-class-name的回调函数给每一行数据设置index属性\r\n    setRowIndex({ row, rowIndex }) {\r\n      row.index = rowIndex\r\n    },\r\n\r\n    // 表格单行选择事件\r\n    handleCurrentChange(row) {\r\n      console.log(row, '表格单行选择事件')\r\n      if (row) {\r\n        // 更改radios的选中值\r\n        this.rowIndex = row.index\r\n        this.$emit('currentChange', row)\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @method 当表格的排序条件发生变化的时候会触发该事件\r\n     * @argument {Object} 回调函数返回的参数\r\n     * @param {Object} column: 当前点击的列\r\n     * @param {String} prop: 当前列对应的字段名称\r\n     * @param {String} order: 当前列的排序状态(ascending: 升序，descending：降序)\r\n     */\r\n    sortChange({ column, prop, order }) {\r\n      this.$emit('sortChange', { column, prop, order })\r\n    },\r\n\r\n    // 合并单元格\r\n    spanMethod({ row, column, rowIndex, columnIndex }) {\r\n      return this.mergeMethod({ row, column, rowIndex, columnIndex, tableData: this.tableData })\r\n    },\r\n\r\n    // 单元格点击事件\r\n    editCell(row, column, cell, event) {\r\n      // console.log(row)\r\n      this.$emit('cellClick', { row, column, cell, event })\r\n    },\r\n\r\n    // 单元格内的输入框失去焦点时触发\r\n    cellInputBlur({ e, row, column }) {\r\n      // console.log(e.target.value, row, column)\r\n      this.$emit('cellInputBlur', { e, row, column })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n  %tableStyle {\r\n    width: 100%;\r\n\r\n    .el-table {\r\n      width: 100%;\r\n\r\n      .el-radio__label {\r\n        padding: 0px; /* 清除el-radio组件默认的内边距 */\r\n      }\r\n\r\n      .cell {\r\n        width: 100% !important;\r\n      }\r\n    }\r\n        .custom-upload {\r\n      /* 解决图片上传后单元格变形问题 */\r\n      ::deep .el-upload-list {\r\n        line-height: 0px;\r\n      }\r\n    }\r\n\r\n    /* 解决element-ui的table表格表头与内容列不对齐问题 */\r\n    th.gutter {\r\n      display: table-cell !important;\r\n    }\r\n\r\n    /* 解决element-ui的fixed列错位问题 */\r\n    .el-table__fixed {\r\n      display: table-cell !important;\r\n      height: 100% !important;\r\n\r\n      .el-table__fixed-body-wrapper {\r\n        top: 48px !important;\r\n      }\r\n    }\r\n  }\r\n\r\n  .table-view {\r\n    @extend %tableStyle;\r\n    flex: 1;\r\n  }\r\n\r\n  .fluid-table {\r\n    @extend %tableStyle;\r\n    height: max-content;\r\n\r\n    .el-table {\r\n      height: 100% !important;\r\n    }\r\n  }\r\n</style>\r\n"]}]}